import { SecurityContext } from "../core.mjs";

//#region ../compiler/src/schema/dom_security_schema.ts
/**
* @license
* Copyright Google LLC All Rights Reserved.
*
* Use of this source code is governed by an MIT-style license that can be
* found in the LICENSE file at https://angular.dev/license
*/
/** Map from tagName|propertyName to SecurityContext. Properties applying to all tags use '*'. */
let _SECURITY_SCHEMA;
function SECURITY_SCHEMA() {
	if (!_SECURITY_SCHEMA) {
		_SECURITY_SCHEMA = {};
		registerContext(SecurityContext.HTML, [
			"iframe|srcdoc",
			"*|innerHTML",
			"*|outerHTML"
		]);
		registerContext(SecurityContext.STYLE, ["*|style"]);
		registerContext(SecurityContext.URL, [
			"*|formAction",
			"area|href",
			"area|ping",
			"audio|src",
			"a|href",
			"a|ping",
			"blockquote|cite",
			"body|background",
			"del|cite",
			"form|action",
			"img|src",
			"input|src",
			"ins|cite",
			"q|cite",
			"source|src",
			"track|src",
			"video|poster",
			"video|src"
		]);
		registerContext(SecurityContext.RESOURCE_URL, [
			"applet|code",
			"applet|codebase",
			"base|href",
			"embed|src",
			"frame|src",
			"head|profile",
			"html|manifest",
			"iframe|src",
			"link|href",
			"media|src",
			"object|codebase",
			"object|data",
			"script|src"
		]);
	}
	return _SECURITY_SCHEMA;
}
function registerContext(ctx, specs) {
	for (const spec of specs) _SECURITY_SCHEMA[spec.toLowerCase()] = ctx;
}

//#endregion
export { SECURITY_SCHEMA };